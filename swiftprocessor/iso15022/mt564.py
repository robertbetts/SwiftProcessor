import re

MT564_REGEX = re.compile(
    r"^(:16R[:]+GENL\s"
        r"(:20C[:]+(?P<reference1>[^\s:]+)\s*)?"
        r"(:20C[:]+(?P<reference2>[^\s:]+)\s*)?"
        r"(:20C[:]+(?P<reference3>[^\s:]+)\s*)?"
        r"(:23G[:]+(?P<function>[^\s:]+)\s*)?"
        r"(:22F[:]+(?P<indicator1>[^\s:]+)\s*)?"
        r"(:22F[:]+(?P<indicator2>[^\s:]+)\s*)?"
        r"(:22F[:]+(?P<indicator3>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<preperation_date>[^\s:]+)\s*)?"
        r"(:25D[:]+(?P<processing_status>[^\s:]+)\s*)?"
        r"(:16R[:]+LINK\s"
            r"(:22F[:]+(?P<link1_type>[^\s:]+)\s*)?"
            r"(:13A[:]+(?P<link1_message>[^\s:]+)\s*)?"
            r"(:20C[:]+(?P<link1_reference>[^\s:]+)\s*)?"
        r":16S[:]+LINK\s)?"
        r"(:16R[:]+LINK\s"
            r"(:22F[:]+(?P<link2_type>[^\s:]+)\s*)?"
            r"(:13A[:]+(?P<link2_message>[^\s:]+)\s*)?"
            r"(:20C[:]+(?P<link2_reference>[^\s:]+)\s*)?"
        r":16S[:]+LINK\s)?"
    r":16S:GENL\s)?"
    r"(:16R:USECU\s)?"
        r"(:35B:(?P<security1>[\s\S][^:]+))?"
        r"(:35B:(?P<security2>[\s\S][^:]+))?"
        r"(:35B:(?P<security3>[\s\S][^:]+))?"
        r"(:16R:FIA\s)?"
            r"(:94B[:]+(?P<place_of_listing>[^\s:]+)\s*)?"
            r"(:22F[:]+(?P<day_count>[^\s:]+)\s*)?"
            r"(:12A[:]+(?P<security_type>[^\s:]+)\s*)?"
            r"(:11A[:]+(?P<security_currency>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date1>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date2>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date3>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date4>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date5>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date6>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date7>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date8>[^\s:]+)\s*)?"
            r"(:98A[:]+(?P<security_date9>[^\s:]+)\s*)?"
            r"(:92A[:]+(?P<coupon_rate>[^\s:]+)\s*)?"
            r"(:36B[:]+(?P<tradable_quantity>[^\s:]+)\s*)?"
        r"(:16S:FIA\s)?"
        r"(:16R:ACCTINFO\s)?"
        r"(:95A[:]+(?P<account_owner>[\s\S][^:]+))?"
        r"(:97A[:]+(?P<safe_keeping_account>[^\s:]+)\s*)?"
        r"(:94A[:]+(?P<account_place_of_safe_keeping>[\s\S][^:]+))?"
        r"(:93A[:]+(?P<balance1>[\s\S][^:]+))?"
        r"(:93A[:]+(?P<balance2>[\s\S][^:]+))?"
        r"(:16S:ACCTINFO\s)?"
    r"(:16S:USECU\s)?"
    r"(:16R:INTSEC\s(.*?):16S:INTSEC\s)?"
    r"(:16R:CADETL\s)?"
        r"(:98A[:]+(?P<cadetl_date1>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_date2>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_date3>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_date4>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_date5>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_date6>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_date7>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_date8>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_period1>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_period2>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_period3>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_period4>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_period5>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_period6>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_period7>[^\s:]+)\s*)?"
        r"(:98A[:]+(?P<cadetl_period8>[^\s:]+)\s*)?"
    r":(16S:CADETL\s)?"
    r"(:16R:CAOPTN\s)?"
        r"(:13A[:]+(?P<caoptn_caon>[^\s:]+)\s*)?"
        r"(:22F[:]+(?P<caoptn_indicator1>[^\s:]+)\s*)?"
        r"(:22F[:]+(?P<caoptn_indicator2>[^\s:]+)\s*)?"
        r"(:94C[:]+(?P<caoptn_place1>[^\s:]+)\s*)?"
        r"(:94C[:]+(?P<caoptn_place2>[^\s:]+)\s*)?"
        r"(:11A[:]+(?P<caoptn_currency>[^\s:]+)\s*)?"
        r"(:17B[:]+(?P<caoptn_flag1>[^\s:]+)\s*)?"
        r"(:17B[:]+(?P<caoptn_flag2>[^\s:]+)\s*)?"
        r"(:17B[:]+(?P<caoptn_flag3>[^\s:]+)\s*)?"
        r"(:17B[:]+(?P<caoptn_flag4>[^\s:]+)\s*)?"
        r"(:17B[:]+(?P<caoptn_flag5>[^\s:]+)\s*)?"
        r"(:17B[:]+(?P<caoptn_flag6>[^\s:]+)\s*)?"
    r"(:16S:CAOPTN\s)?"
    r"(:16R:ADDINFO\s(.*?):16S:ADDINFO)?"
    r".*",
    re.DOTALL
)